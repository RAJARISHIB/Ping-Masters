<div class="board-page">

    <!-- Top Bar -->
    <header class="board-header flex items-center justify-between px-8 py-3">
        <span class="text-xl font-semibold text-gray-800 tracking-tight">Ping Masters</span>
        <div class="flex items-center gap-2">
            <button class="text-sm text-gray-600 px-4 py-2 rounded-full hover:bg-gray-100 transition-colors duration-150 font-medium"
                (click)="navigateToBorrow()">
                Borrow
            </button>
            <button class="text-sm text-gray-600 px-4 py-2 rounded-full hover:bg-gray-100 transition-colors duration-150 font-medium">
                Profile
            </button>
            <button class="text-sm text-gray-600 px-4 py-2 rounded-full hover:bg-gray-100 transition-colors duration-150 font-medium"
                (click)="signOut()">
                Sign out
            </button>
            <app-navbar></app-navbar>
        </div>
    </header>

    <!-- Main Content -->
    <main class="board-main flex gap-6 px-8 py-6">

        <!-- Left Column -->
        <div class="flex flex-col gap-5 flex-1 min-w-0">

            <!-- User Card -->
            <div class="flex items-center gap-4 bg-white rounded-2xl px-6 py-4 board-card">
                @if (user(); as currentUser) {
                    <div class="flex items-center justify-center rounded-full bg-blue-600 text-white text-lg font-semibold w-11 h-11 shrink-0">
                        {{ (currentUser.displayName || currentUser.email || 'U')[0].toUpperCase() }}
                    </div>
                    <div class="flex flex-col">
                        <span class="text-sm font-semibold text-gray-800">{{ currentUser.displayName || 'User' }}</span>
                        <span class="text-xs text-gray-400 mt-0.5">{{ currentUser.email || 'No email linked' }}</span>
                    </div>
                } @else {
                    <div class="flex items-center justify-center rounded-full bg-blue-600 text-white text-lg font-semibold w-11 h-11 shrink-0">
                        U
                    </div>
                    <div class="flex flex-col">
                        <span class="text-sm font-semibold text-gray-800">Loading profile...</span>
                        <span class="text-xs text-gray-400 mt-0.5">&nbsp;</span>
                    </div>
                }
            </div>

            <!-- History Section -->
            <div class="board-card bg-white rounded-2xl overflow-hidden">
                <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100">
                    <span class="text-xs font-semibold text-gray-500 uppercase tracking-widest">History</span>
                    <span class="text-xs text-gray-400">{{ historyItems().length }} entries</span>
                </div>
                <div *ngIf="loading()" class="px-6 py-4 text-xs text-gray-400">Loading history...</div>
                <div *ngIf="!loading() && historyItems().length === 0" class="px-6 py-4 text-xs text-gray-400">No history events yet.</div>
                <div class="flex flex-col gap-1 p-3">
                    @for (item of historyItems(); track item.id) {
                        <app-history-item
                            [title]="item.title"
                            [amount]="item.amount"
                            [status]="item.status"
                            (itemClicked)="goToLoan(item.id)">
                        </app-history-item>
                    }
                </div>
            </div>

        </div>

        <!-- Right Column -->
        <div class="flex flex-col gap-5 w-72 shrink-0">

            <!-- Wallets Section -->
            <div class="board-card bg-white rounded-2xl overflow-hidden">
                <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100">
                    <span class="text-xs font-semibold text-gray-500 uppercase tracking-widest">Wallets</span>
                    <button class="text-xs text-blue-600 hover:text-blue-800 transition-colors duration-150 font-semibold">
                        + Add
                    </button>
                </div>
                <div *ngIf="loading()" class="px-6 py-4 text-xs text-gray-400">Loading wallets...</div>
                <div *ngIf="!loading() && wallets().length === 0" class="px-6 py-4 text-xs text-gray-400">No wallets found for this user.</div>
                <div class="flex flex-col gap-1 p-3">
                    @for (wallet of wallets(); track wallet) {
                        <app-wallet-item [address]="wallet"></app-wallet-item>
                    }
                </div>
            </div>

        </div>

    </main>

</div>
