<div class="login-page">
  <section class="login-card" role="main" aria-labelledby="login-title">
    <header class="brand">
      <div class="brand-mark" aria-hidden="true">PM</div>
      <div class="brand-name">Ping Masters</div>
    </header>

    @if (user$ | async; as user) {
      <h1 id="login-title" class="title">Welcome</h1>
      <p class="subtitle">Youâ€™re signed in with Google.</p>

      <div class="profile" aria-label="Signed in profile">
        @if (user.photoURL) {
          <img class="avatar" [src]="user.photoURL" alt="" referrerpolicy="no-referrer" />
        } @else {
          <div class="avatar placeholder" aria-hidden="true">
            {{ getInitials(user.displayName ?? user.email) }}
          </div>
        }

        <div class="profile-meta">
          <div class="profile-name">
            {{ user.displayName ?? user.email ?? 'Google user' }}
          </div>
          @if (user.email) {
            <div class="profile-email">{{ user.email }}</div>
          }
        </div>
      </div>

      <button class="btn" type="button" (click)="signOut()" [disabled]="working()">
        <span>Sign out</span>
        @if (working()) {
          <span class="spinner" aria-hidden="true"></span>
        }
      </button>
    } @else {
      <h1 id="login-title" class="title">Sign in</h1>
      <p class="subtitle">Use your Google Account to continue to Ping Masters.</p>

      <button class="btn btn-google" type="button" (click)="signInWithGoogle()" [disabled]="working()">
        <span class="google-icon" aria-hidden="true">
          <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
            <path
              fill="#FFC107"
              d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4c-11.046 0-20 8.954-20 20s8.954 20 20 20 20-8.954 20-20c0-1.341-.138-2.65-.389-3.917z"
            />
            <path
              fill="#FF3D00"
              d="M6.306 14.691l6.571 4.819C14.655 15.108 19.0 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4c-7.682 0-14.344 4.334-17.694 10.691z"
            />
            <path
              fill="#4CAF50"
              d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.191-5.238C29.211 35.091 26.715 36 24 36c-5.182 0-9.592-3.306-11.227-7.936l-6.517 5.022C9.572 39.556 16.227 44 24 44z"
            />
            <path
              fill="#1976D2"
              d="M43.611 20.083H42V20H24v8h11.303c-.793 2.213-2.231 4.082-4.084 5.278l6.191 5.238C40.971 36.205 44 30.723 44 24c0-1.341-.138-2.65-.389-3.917z"
            />
          </svg>
        </span>
        <span>Sign in with Google</span>
        @if (working()) {
          <span class="spinner" aria-hidden="true"></span>
        }
      </button>

      <p class="fineprint">Tip: enable popups for the smoothest sign-in experience.</p>
    }

    @if (error(); as message) {
      <div class="error" role="alert">{{ message }}</div>
    }
  </section>
</div>
