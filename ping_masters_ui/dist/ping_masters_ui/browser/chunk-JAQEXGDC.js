import{a as G}from"./chunk-7NHOIAAD.js";import{b as D}from"./chunk-ME25THNO.js";import{a as B}from"./chunk-3OKVKUBR.js";import{Aa as l,Ba as v,C as f,Ca as w,E as x,F as h,G as k,H as S,Ka as U,L as b,La as I,R as O,S as a,W as L,X as z,Xa as V,ca as c,da as T,ea as p,fb as F,l as E,ma as i,n as y,na as o,oa as m,q as P,ra as _,s as M,sa as u,ua as C,va as d}from"./chunk-RRZ5U6OK.js";function A(n,t){if(n&1&&m(0,"img",10),n&2){let e=d();u("src",e.photoURL,O)}}function H(n,t){if(n&1&&(i(0,"div",11),l(1),o()),n&2){let e=d(),r=d();a(),w(" ",r.getInitials(e.displayName??e.email)," ")}}function N(n,t){if(n&1&&(i(0,"div",14),l(1),o()),n&2){let e=d();a(),v(e.email)}}function $(n,t){n&1&&m(0,"span",16)}function W(n,t){if(n&1){let e=_();i(0,"h1",7),l(1,"Welcome"),o(),i(2,"p",8),l(3,"You\u2019re signed in with Google."),o(),i(4,"div",9),c(5,A,1,1,"img",10)(6,H,2,1,"div",11),i(7,"div",12)(8,"div",13),l(9),o(),c(10,N,2,1,"div",14),o()(),i(11,"button",15),C("click",function(){x(e);let s=d();return h(s.signOut())}),i(12,"span"),l(13,"Sign out"),o(),c(14,$,1,0,"span",16),o()}if(n&2){let e=t,r=d();a(5),p(e.photoURL?5:6),a(4),w(" ",e.displayName??e.email??"Google user"," "),a(),p(e.email?10:-1),a(),u("disabled",r.working()),a(3),p(r.working()?14:-1)}}function R(n,t){n&1&&m(0,"span",16)}function Y(n,t){if(n&1){let e=_();i(0,"h1",7),l(1,"Sign in"),o(),i(2,"p",8),l(3,"Use your Google Account to continue to Velox."),o(),i(4,"button",17),C("click",function(){x(e);let s=d();return h(s.signInWithGoogle())}),i(5,"span",18),k(),i(6,"svg",19),m(7,"path",20)(8,"path",21)(9,"path",22)(10,"path",23),o()(),S(),i(11,"span"),l(12,"Sign in with Google"),o(),c(13,R,1,0,"span",16),o(),i(14,"p",24),l(15,"Tip: enable popups for the smoothest sign-in experience."),o()}if(n&2){let e=d();a(4),u("disabled",e.working()),a(9),p(e.working()?13:-1)}}function q(n,t){n&1&&(i(0,"div",6),l(1),o()),n&2&&(a(),v(t))}var j=class n{constructor(t){this._eventbus=t;this.user$.pipe(y(e=>e!==null),E(e=>e.uid),P(),M(e=>this.authService.needsGetStarted(e)),D()).subscribe(e=>{if(e){this.router.navigateByUrl("/get-started");return}this.router.navigateByUrl("/board").then(()=>{this._eventbus.emit({key:"board",data:{message:"Hello from LoginComponent"}})})})}authService=f(G);router=f(F);user$=this.authService.user$;working=b(!1);error=b(null);async signInWithGoogle(){await this.run(()=>this.authService.signInWithGoogle())}async signOut(){await this.run(()=>this.authService.logout())}getInitials(t){let e=(t??"").trim();if(!e)return"U";let r=e.split(/\s+/).filter(Boolean),s=r[0]?.[0]??"",g=r.length>1?r[r.length-1]?.[0]??"":"";return`${s}${g}`.toUpperCase()||"U"}async run(t){if(!this.working()){this.error.set(null),this.working.set(!0);try{await t()}catch(e){this.error.set(this.humanizeError(e))}finally{this.working.set(!1)}}}humanizeError(t){switch(this.getFirebaseErrorCode(t)){case"auth/popup-blocked":return"Popup blocked. Allow popups for this site and try again.";case"auth/popup-closed-by-user":return"Sign-in was cancelled.";case"auth/operation-not-allowed":return"Google sign-in is not enabled for this Firebase project.";case"auth/unauthorized-domain":return"This domain is not authorized for Firebase Auth.";default:return t instanceof Error&&t.message?t.message:"Something went wrong. Please try again."}}getFirebaseErrorCode(t){if(!t||typeof t!="object")return null;let e=t.code;return typeof e=="string"?e:null}static \u0275fac=function(e){return new(e||n)(L(B))};static \u0275cmp=z({type:n,selectors:[["app-login"]],decls:11,vars:4,consts:[[1,"login-page"],["role","main","aria-labelledby","login-title",1,"login-card"],[1,"brand"],["aria-hidden","true",1,"brand-mark"],["src","logo.png","alt","",1,"brand-logo"],[1,"brand-name"],["role","alert",1,"error"],["id","login-title",1,"title"],[1,"subtitle"],["aria-label","Signed in profile",1,"profile"],["alt","","referrerpolicy","no-referrer",1,"avatar",3,"src"],["aria-hidden","true",1,"avatar","placeholder"],[1,"profile-meta"],[1,"profile-name"],[1,"profile-email"],["type","button",1,"btn",3,"click","disabled"],["aria-hidden","true",1,"spinner"],["type","button",1,"btn","btn-google",3,"click","disabled"],["aria-hidden","true",1,"google-icon"],["viewBox","0 0 48 48","xmlns","http://www.w3.org/2000/svg"],["fill","#FFC107","d","M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4c-11.046 0-20 8.954-20 20s8.954 20 20 20 20-8.954 20-20c0-1.341-.138-2.65-.389-3.917z"],["fill","#FF3D00","d","M6.306 14.691l6.571 4.819C14.655 15.108 19.0 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4c-7.682 0-14.344 4.334-17.694 10.691z"],["fill","#4CAF50","d","M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.191-5.238C29.211 35.091 26.715 36 24 36c-5.182 0-9.592-3.306-11.227-7.936l-6.517 5.022C9.572 39.556 16.227 44 24 44z"],["fill","#1976D2","d","M43.611 20.083H42V20H24v8h11.303c-.793 2.213-2.231 4.082-4.084 5.278l6.191 5.238C40.971 36.205 44 30.723 44 24c0-1.341-.138-2.65-.389-3.917z"],[1,"fineprint"]],template:function(e,r){if(e&1&&(i(0,"div",0)(1,"section",1)(2,"header",2)(3,"div",3),m(4,"img",4),o(),i(5,"div",5),l(6,"Velox"),o()(),c(7,W,15,5),U(8,"async"),T(9,Y,16,2),c(10,q,2,1,"div",6),o()()),e&2){let s,g;a(7),p((s=I(8,2,r.user$))?7:9,s),a(3),p((g=r.error())?10:-1,g)}},dependencies:[V],styles:["[_nghost-%COMP%]{display:block;min-height:100%}.login-page[_ngcontent-%COMP%]{min-height:100vh;display:grid;place-items:center;padding:24px;background:radial-gradient(1200px circle at 20% -10%,rgba(66,133,244,.18),transparent 60%),radial-gradient(900px circle at 100% 10%,rgba(219,68,55,.14),transparent 55%),radial-gradient(900px circle at 0% 100%,rgba(15,157,88,.12),transparent 50%),radial-gradient(900px circle at 80% 110%,rgba(244,180,0,.14),transparent 50%),#f5f6f8}.login-card[_ngcontent-%COMP%]{width:min(420px,100%);background:#fff;border:1px solid #dadce0;border-radius:20px;padding:40px 40px 32px;box-shadow:0 1px 2px #3c40434d,0 2px 6px #3c404326}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:22px}.brand-mark[_ngcontent-%COMP%]{width:72px;height:36px;border-radius:10px;display:grid;place-items:center;background:#1a73e814;border:1px solid rgba(26,115,232,.18);overflow:hidden}.brand-logo[_ngcontent-%COMP%]{width:100%;height:100%;display:block;object-fit:contain}.brand-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#3c4043}.title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:24px;font-weight:500;color:#202124;letter-spacing:-.01em}.subtitle[_ngcontent-%COMP%]{margin:0 0 24px;font-size:14px;color:#5f6368;line-height:1.4}.profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:14px;border:1px solid #e0e3e7;border-radius:14px;background:#fafbfd;margin-bottom:18px}.avatar[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:50%;object-fit:cover}.avatar.placeholder[_ngcontent-%COMP%]{display:grid;place-items:center;font-weight:700;font-size:14px;color:#1a73e8;background:#1a73e81f;border:1px solid rgba(26,115,232,.18)}.profile-meta[_ngcontent-%COMP%]{min-width:0}.profile-name[_ngcontent-%COMP%]{font-weight:600;color:#202124;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.profile-email[_ngcontent-%COMP%]{color:#5f6368;font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.btn[_ngcontent-%COMP%]{width:100%;height:44px;padding:0 16px;border-radius:999px;border:1px solid #dadce0;background:#fff;color:#3c4043;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:12px;position:relative;-webkit-user-select:none;user-select:none;transition:background .12s ease,box-shadow .12s ease,transform .12s ease}.btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f8f9fa;box-shadow:0 1px 2px #3c40432e}.btn[_ngcontent-%COMP%]:active:not(:disabled){background:#f1f3f4;transform:translateY(1px)}.btn[_ngcontent-%COMP%]:focus-visible{outline:3px solid rgba(26,115,232,.35);outline-offset:2px}.btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.65;box-shadow:none;transform:none}.btn-google[_ngcontent-%COMP%]   .google-icon[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-flex}.btn-google[_ngcontent-%COMP%]   .google-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;display:block}.spinner[_ngcontent-%COMP%]{position:absolute;right:14px;width:16px;height:16px;border-radius:50%;border:2px solid rgba(60,64,67,.25);border-top-color:#3c4043cc;animation:_ngcontent-%COMP%_spin .7s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.fineprint[_ngcontent-%COMP%]{margin:18px 0 0;font-size:12px;color:#5f6368;line-height:1.4}.error[_ngcontent-%COMP%]{margin-top:16px;padding:10px 12px;border-radius:12px;background:#fce8e6;border:1px solid #f6aea9;color:#a50e0e;font-size:13px}@media (max-width: 480px){.login-card[_ngcontent-%COMP%]{border-radius:16px;padding:28px 22px 22px}}"],changeDetection:0})};export{j as LoginComponent};
